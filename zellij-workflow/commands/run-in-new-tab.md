---
description: Run Claude session in new zellij tab with given instructions
argument-hint: <instructions or plan-file-path>
---

# Run in New Tab

Launch an interactive Claude Code session in a new zellij tab or pane.

## Input

- **INSTRUCTIONS**: `$ARGUMENTS` -- prompt text or path to a plan file

## Steps

### 1. Determine tab name and prompt

If `$ARGUMENTS` is a file path (ends with `.md`), the prompt should be:
```
Execute the plan from <plan-file-path>. Use superpowers:executing-plans.
```
Otherwise use `$ARGUMENTS` directly as the prompt.

Generate a short tab name (1-2 words) from the content.
Fallback: `claude-<HH:MM>`.

### 2. Write bash launch script

```bash
SCRIPT=$(mktemp /tmp/claude-tab-XXXXXX.sh)
cat > "$SCRIPT" << 'SCRIPT_EOF'
#!/bin/bash
cd '<PROJECT_DIR>'
PROMPT='<escaped prompt -- single quotes escaped as '"'"'>'
clear
echo "Launching claude with prompt: $PROMPT"
echo ""
exec claude --dangerously-skip-permissions "$PROMPT"
SCRIPT_EOF
chmod +x "$SCRIPT"
```

### 3. Create tab and launch

**In a new tab (default):**

```bash
TAB_NAME="<auto-generated>"

timeout 5 zellij action new-tab --name "$TAB_NAME" && \
sleep 0.3 && \
timeout 5 zellij action write-chars "bash '$SCRIPT'
" || {
  _rc=$?
  echo "Command failed. Diagnosing..."
  if [ -z "$ZELLIJ" ]; then echo "Not in zellij session"
  elif [ $_rc -eq 124 ]; then echo "Timed out -- zellij may be hanging"
  elif ! command -v claude &>/dev/null; then echo "claude not found in PATH"
  else echo "Unknown error (exit code: $_rc)"
  fi
  exit $_rc
}
```

**In a new pane:**

```bash
timeout 5 zellij run -- bash "$SCRIPT" || {
  _rc=$?
  echo "Command failed. Diagnosing..."
  if [ -z "$ZELLIJ" ]; then echo "Not in zellij session"
  elif [ $_rc -eq 124 ]; then echo "Timed out -- zellij may be hanging"
  elif ! command -v claude &>/dev/null; then echo "claude not found in PATH"
  else echo "Unknown error (exit code: $_rc)"
  fi
  exit $_rc
}
```

## Examples

```bash
/run-in-new-tab Execute plan from docs/plans/skill-audit-plan.md. Use executing-plans.
/run-in-new-tab Refactor auth module following DRY principles
/run-in-new-tab Fix all failing tests in spec-reviewer plugin
```

## Result

- New zellij tab or pane created
- Interactive Claude Code session running with the given instructions
- Session remains a working chat after initial prompt
